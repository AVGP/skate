!function(){"use strict";function a(a,c){var d=new b(a,c),e=function(){var b=document.createElement(a);return d.init(b,!0),b};return e.listener=d,e}function b(b,c){if(c||(c={}),"function"==typeof c&&(c={insert:c}),"string"==typeof c.restrict){var d=c.restrict;c.restrict=function(a){return t(a,d)}}this.component=c,this.id=b,k(this.component,a.defaults),this.component.ready&&a.hide(this.id),this.component.listen&&this.listen()}function c(a,b){d(a,b,function(){e(a,b)})}function d(b,c,d){var e=/^[^(]+\([^,)]+,/,f=b.component,g=f.ready;return d=d||function(){},c[a.isReadyTriggeredProperty]||(c[a.isReadyTriggeredProperty]=[]),c[a.isReadyTriggeredProperty].indexOf(b.id)>-1?d():(c[a.isReadyTriggeredProperty].push(b.id),k(c,f.extend),f.attrs&&v.addAttributeListener(c,f.attrs),void(g&&e.test(g)?g(c,d):g?(g(c),d()):d()))}function e(b,c){var d=b.component,e=d.insert;c[a.isInsertTriggeredProperty]||(c[a.isInsertTriggeredProperty]=[]),c[a.isInsertTriggeredProperty].indexOf(b.id)>-1||document.documentElement.contains(c)&&(c[a.isInsertTriggeredProperty].push(b.id),i(c,s),e&&e(c))}function f(b){m(b,function(b){a.listeners(b).forEach(function(a){a.component.attrs&&v.removeAttributeListener(a,b),a.component.remove&&a.component.remove(b)})})}function g(){var b=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver;if(b){var c=new b(function(b){b.forEach(function(b){b.addedNodes&&b.addedNodes.length&&a.init(b.addedNodes),b.removedNodes&&b.removedNodes.length&&f(b.removedNodes)})});return c.observe(document,{childList:!0,subtree:!0}),{addAttributeListener:function(a,c){function d(a,b,c){(a.init||a.update||a)(b,c)}function e(a,b,c,d){(a.update||a)(b,c,d)}function f(a,b,c){a.remove(b,c),delete g[name]}var g={},h=new b(function(b){b.forEach(function(b){var h,i,j=b.attributeName,k=a.attributes[j],l=c[j];return l?(h=g[j],k&&(i=g[j]=k.nodeValue),k&&void 0===h&&(l.init||l.update||l)?d(l,a,i):k&&void 0!==h&&(l.update||l)?e(l,a,i,h):!k&&l.remove?f(l,a,h):void 0):void 0})});h.observe(a,{attributes:!0});for(var i=0;i<a.attributes.length;i++){var j=a.attributes[i],k=c[j.nodeName];k&&d(k,a,j.nodeValue)}},removeAttributeListener:function(){}}}}function h(){document.addEventListener("DOMNodeInserted",function(b){a.init(b.target)}),document.addEventListener("DOMNodeRemoved",function(a){f(a.target)});var b={1:function(a,b,c){(a.update||a)(b,c.newValue,c.prevValue)},2:function(a,b,c){(a.init||a.update||a)(b,c.newValue)},3:function(a,b,c){a.remove&&a.remove(b,c.prevValue)}};return{addAttributeListener:function(a,c){a.addEventListener("DOMAttrModified",function(d){var e=c[d.attrName];e&&b[d.attrChange](e,a,d)});for(var d=0;d<a.attributes.length;d++){var e=a.attributes[d],f=c[e.nodeName];f&&b[2](f,a,{newValue:e.nodeValue})}},removeAttributeListener:function(){}}}function i(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function j(a,b){var c=l(a);return c.forEach(function(a,d){c[d]+=b}),c.join(",")}function k(a,b){for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c])}function l(a){var b=a.split(",");return b.forEach(function(a,c){b[c]=a.replace(/^\s+/,"").replace(/\s+$/,"")}),b}function m(a,b){a.nodeType?a=[a]:"string"==typeof a&&(a=document.querySelectorAll([a,"."+a,"["+a+"]"].join(", ")));for(var c=0;c<a.length;c++)1===a[c].nodeType&&b(a[c],c)}function n(a){return(a.tagName||"").toLowerCase()}function o(a){return[].map.call(a.attributes||[],function(a){return a.nodeName})}function p(a){return(a.className||"").split(" ")}var q=document.getElementsByTagName("head")[0],r=document.createElement("style"),s="_skate",t=function(){var a=Element.prototype.matches;return["moz","ms","o","webkit"].some(function(b){var c=b+"MatchesSelector";return Element.prototype[c]?(a=c,!0):void 0}),function(b,c){return b&&1===b.nodeType&&b[a](c)}}(),u=[],v=g()||h();a.isReadyTriggeredProperty="__skate_ready_triggered",a.isInsertTriggeredProperty="__skate_insert_triggered",a.defaults={attributes:!1,extend:{},listen:!0,restrict:function(){return!0}},a.init=function(b){return m(b,function(b){a.listeners(b).forEach(function(a){a.init(b)})}),b},a.destroy=function(){return Object.keys(u).forEach(function(a){u[a].deafen()}),a},a.hide=function(b){var c=["position: absolute !important","clip: rect(0, 0, 0, 0)"];return r.sheet.insertRule(j(b,":not(."+s+")")+"{"+c.join(";")+"}",r.sheet.cssRules.length),a},a.listeners=function(a){var b=[],c=n(a),d=o(a),e=p(a);return c&&u[c]&&b.push(u[c]),d.concat(e).forEach(function(a){u[a]&&b.push(u[a])}),b},b.prototype={init:function(a){var b=this;return m(a,function(a){if(!b.component.restrict(a))throw new Error("Restrictions don't allow \""+b.id+'" to be applied to:"\n'+document.createElement("div").appendChild(a.cloneNode(!0)).parentNode.innerHTML+'".');c(b,a)}),this},listen:function(){if(u[this.id])throw new Error('Listener for "'+this.id+'" already registered.');return u[this.id]=this,this.init(this.id),this},deafen:function(){return delete u[this.id],this}},q.appendChild(r),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();