!function(){"use strict";function a(a,f){return 1===a.nodeType?d(a):"string"==typeof a&&1===arguments.length?e(a):"string"!=typeof a&&"number"==typeof a.length?c(a):new b(a,f)}function b(b,c){a.instances.push(this),this.adapter=new E(this),this.elements=[],this.listening=!1,this.removeListener=null,this.selector=b,"function"==typeof c&&(c={insert:c}),p(this.component=c,a.defaults),c.ready&&l(b),c.listen&&this.listen()}function c(a){return[].slice.call(a).forEach(function(a){d(a)})}function d(b){return a.instances.forEach(function(a){w(b,a.selector)&&f(a,b)}),b}function e(a){return c(document.querySelectorAll(a))}function f(a,b){function c(c){c&&(a.elements.splice(f,1,b),b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),p(b=c,a.component,y)),g(a,b)}var d=/^[^(]+\([^)]+\)/,e=a.component.ready,f=a.elements.length;a.elements.indexOf(b)>-1||(a.elements.push(b),p(b,a.component,y),e&&d.test(e)?e.call(b,c):e?(e.call(b),c()):c())}function g(a,b){var c=a.component.insert;n(b,u),c&&c.call(b)}function h(a){this.listener=null,this.id=u+"-"+Math.random().toString().replace("0.",""),this.skate=a}function i(){s.innerHTML=D.join(",")+"{"+C+"animation: "+A+" .01s}"}function j(){q.appendChild(r),q.appendChild(s),r.innerHTML="@"+C+"keyframes "+A+"{from{opacity:1}to{opacity:1}}"}function k(a){this.listener=null,this.skate=a}function l(a){var b=["position: absolute !important","clip: rect(0, 0, 0, 0)"];t.sheet.insertRule(o(a,":not(."+u+")")+"{"+b.join(";")+"}",t.sheet.cssRules.length)}function m(a){var b=a.split(",");return b.forEach(function(a,c){b[c]=a.replace(/^\s+/,"").replace(/\s+$/,"")}),b}function n(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function o(a,b){var c=m(a);return c.forEach(function(a,d){c[d]+=b}),c.join(",")}function p(a,b,c){for(var d in b)c&&c.indexOf(d)>-1||"undefined"==typeof a[d]&&(a[d]=b[d])}var q=document.getElementsByTagName("head")[0],r=document.createElement("style"),s=document.createElement("style"),t=document.createElement("style"),u="skate",v=["moz","ms","o","webkit"],w=function(){var a=Element.prototype.matches;return v.some(function(b){var c=b+"MatchesSelector";return Element.prototype[c]?(a=c,!0):void 0}),function(b,c){return b[a](c)}}(),x=function(){var a=0,b=["ms","moz","webkit","o"];if(window.requestAnimationFrame)return window.requestAnimationFrame;for(var c=0;c<b.length;++c){var d=b[c]+"RequestAnimationFrame";if("function"==typeof window[d])return window[d]}return window.requestAnimationFrame?void 0:function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}}();x.end=function(){var a=window.cancelAnimationFrame||clearTimeout;return function(b){a(b)}}(),x.repeat=function(a){var b=function(){return a(),x(b)};return b()},a.defaults={extend:!0,listen:!0},a.instances=[],a.destroy=function(){for(var b=a.instances.length-1;b>=0;b--)a.instances[b].destroy();return a};var y=Object.keys(a.defaults);y.concat(["ready","insert","remove"]),b.prototype={listen:function(){if(this.listening)return this;var a=this;return this.listening=!0,this.adapter.listen(function(b){f(a,b)}),this.component.remove&&(this.removeListener=x.repeat(function(){for(var b=a.elements.length-1;b>-1;b--){var c=a.elements[b];c.parentNode||(a.elements.splice(b,1),a.component.remove.call(c))}})),this},deafen:function(){return this.listening?(this.adapter.deafen(),this.listening=!1,this.removeListener&&x.end(this.removeListener),this):this},destroy:function(){this.deafen(),a.instances.splice(a.instances.indexOf(this),1)}};var z=["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"],A="__skate",B=function(){var a=document.documentElement.style,b=!1;return"undefined"!=typeof a.animation?"":(v.some(function(c){return"undefined"!=typeof a[c+"Animation"]?(b=c,!0):void 0}),b)}(),C=B?"-"+B+"-":"",D=[];h.prototype={constructor:h,listen:function(a){var b=this,c=document.querySelectorAll(o(this.skate.selector,".skate:not(."+this.id+")"));this.listener=function(c){c.animationName===A&&w(c.target,b.skate.selector)&&(n(c.target,b.id),a(c.target))};for(var d=0;d<c.length;d++)this.listener({animationName:A,target:c[d]});return z.forEach(function(a){document.addEventListener(a,b.listener,!1)}),m(this.skate.selector).forEach(function(a){-1===D.indexOf(a)&&D.push(a)}),i(),this},deafen:function(){var a=this;return z.forEach(function(b){document.removeEventListener(b,a.listener,!1)}),this.listener=null,m(this.skate.selector).forEach(function(a){var b=D.indexOf(a);-1!==b&&D.splice(b,1)}),i(),this}},k.prototype={constructor:k,listen:function(a){var b=this,c=document.querySelectorAll(this.skate.selector);this.listener=function(c){c.target.msMatchesSelector&&c.target.msMatchesSelector(b.skate.selector)&&a(c.target)};for(var d=0;d<c.length;d++)this.listener({target:c[d]});return document.addEventListener("DOMSubtreeModified",this.listener),this},deafen:function(){return document.removeEventListener("DOMSubtreeModified",this.listener),this.listener=null,this}};var E=function(){return B===!1?k:h}();E===h&&j(),q.appendChild(t),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();