!function(){"use strict";function a(a,c){var d=new b(new u(a));return c&&(d.add(c),d.listen()),d}function b(a){this.adapter=a,this.listening=!1,this.removeListener=!1,this.removeRegistry=[],this.events={ready:[],insert:[],remove:[]}}function c(a,b){a.trigger("ready",b),g(b),a.trigger("insert",b)}function d(a){this.index=null,this.name=null,this.selector=a,f(this.selector)}function e(a){this.listener=null,this.selector=a,f(a)}function f(a){var b=a.split(","),c=["height: 0 !important","width: 0 !important","overflow: hidden !important","margin: 0 !important","padding: 0 !important"];for(var d in b)b[d]+=":not(."+n+")";m.sheet.insertRule(b.join(",")+"{"+c.join(";")+"}",m.sheet.cssRules.length)}function g(a){a.className+=" "+n}function h(){j.appendChild(k),j.appendChild(l),q.forEach(function(a){document.addEventListener(a,function(a){s[a.animationName](a.target)},!1)})}var i=["moz","ms","o","webkit"],j=document.getElementsByTagName("head")[0],k=document.createElement("style"),l=document.createElement("style"),m=document.createElement("style"),n="__skate",o=function(){var a=0,b=["ms","moz","webkit","o"];if(window.requestAnimationFrame)return window.requestAnimationFrame;for(var c=0;c<b.length;++c){var d=b[c]+"RequestAnimationFrame";if("function"==typeof window[d])return window[d]}return window.requestAnimationFrame?void 0:function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}}();o.end=function(){return window.cancelAnimationFrame?window.cancelAnimationFrame:function(a){clearTimeout(a)}}(),o.repeat=function(a){var b=function(){return a(),o(b)};return b()},b.prototype={add:function(a){"function"==typeof a&&(a={ready:a});for(var b in this.events)this.events.hasOwnProperty(b)&&a[b]&&this.on(b,a[b]);return this},remove:function(a){"function"==typeof a&&(a={ready:a});for(var b in this.events)this.events.hasOwnProperty(b)&&a[b]&&this.off(b,a[b]);return this},on:function(a,b){var c=this,d="remove"===a&&!this.removeListener;return this.events[a].push(b),d&&(this.removeListener=o.repeat(function(){for(var a=c.removeRegistry.length-1;a>-1;a--){var b=c.removeRegistry[a];b.parentNode||(c.removeRegistry.splice(a,1),c.trigger("remove",b))}})),this},off:function(a,b){var c="remove"===a&&this.removeListener&&!this.events.remove.length;return b?this.events[a].splice(this.events[a].indexOf(b),1):this.events[a]=[],c&&o.end(this.removeListener),this},listen:function(){if(this.listening)return this;var a=this;return this.listening=!0,this.adapter.listen(function(b){c(a,b)}),this},deafen:function(){return this.listening?(this.adapter.deafen(),this.listening=!1,this.removeListener&&o.end(this.removeListener),this):this},trigger:function(a,b){return"insert"===a&&this.removeRegistry.push(b),this.events[a].forEach(function(a){a(b)}),this}};var p=0,q=["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"],r="__skate",s={},t=function(){var a=document.documentElement.style,b=!1;return"undefined"!=typeof a.animation?"":(i.some(function(c){return"undefined"!=typeof a[c+"Animation"]?(b=c,!0):void 0}),b)}();d.prototype={constructor:d,listen:function(a){var b="-"+t+"-";return this.index=p,this.name=r+p,s[this.name]=a,k.sheet.insertRule("@"+b+"keyframes "+this.name+"{from{opacity:1}to{opacity:1}}",this.index),l.sheet.insertRule(this.selector+"{"+b+"animation:"+this.name+" .01s}",this.index),++p,this},deafen:function(){return k.sheet.deleteRule(k.sheet.cssRules.item(this.index)),l.sheet.deleteRule(l.sheet.cssRules.item(this.index)),delete s[this.name],this.index=null,this.name=null,--p,this}},e.prototype={constructor:e,listen:function(a){var b=this,c=document.querySelectorAll(this.selector);this.listener=function(c){c.target.msMatchesSelector(b.selector)&&a(c.target)};for(var d=0;d<c.length;d++)a(c[d]);return document.addEventListener("DOMNodeInserted",this.listener,!1),this},deafen:function(){return document.removeEventListener("DOMNodeInserted",this.listener),this.listener=null,this}};var u=function(){return t?d:e}();u===d&&h(),j.appendChild(m),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();