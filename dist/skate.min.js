!function(){"use strict";function a(a,c){return new b(a,c)}function b(a,b){this.adapter=new r(this),this.selector=a,this.events={ready:[],insert:[],remove:[]},b&&this.add(b).listen()}function c(a){this.skate=a,this.events={},this.listeners={},this.selectors={}}function d(a){g(m[a.animationName.replace(o,"")],a.target)}function e(){l.type=k.type="text/css",j.appendChild(k),j.appendChild(l),n.forEach(function(a){document.addEventListener(a,d,!1)})}function f(a){this.skate=a}function g(a,b){-1===q.indexOf(b)&&(q.push(b),a.skate.trigger("ready",b),b.setAttribute("data-skate",i++),a.skate.trigger("insert",b))}var h=["moz","ms","o","webkit"],i=0,j=document.getElementsByTagName("head")[0],k=document.createElement("style"),l=document.createElement("style");b.prototype={add:function(a){"function"==typeof a&&(a={ready:a});for(var b in this.events)this.events.hasOwnProperty(b)&&a[b]&&this.on(b,a[b]);return this},remove:function(a){"function"==typeof a&&(a={ready:a});for(var b in this.events)this.events.hasOwnProperty(b)&&a[b]&&this.off(b,a[b]);return this},on:function(a,b){return this.events[a].push(b),this},off:function(a,b){return b?this.events[a].splice(this.events[a].indexOf(b),1):this.events[a]=[],this},listen:function(){return this.adapter.listen(),this},deafen:function(){return this.adapter.deafen(),this},trigger:function(a,b){return this.events[a].forEach(function(a){a(b)}),this}};var m=[],n=["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"],o="__skate",p=function(){var a=document.documentElement.style,b=!1;return"undefined"!=typeof a.animation?"":(h.some(function(c){return"undefined"!=typeof a[c+"Animation"]?(b=c,!0):void 0}),b)}();c.prototype={constructor:c,listen:function(){m.push(this);var a=m.indexOf(this),b=o+a,c="-"+p+"-";k.sheet.insertRule("@"+c+"keyframes "+b+"{from{opacity:1}to{opacity:1}}",a),l.sheet.insertRule(this.skate.selector+"{"+c+"animation:"+b+" .01s}",a);var d=this.skate.selector.split(","),e=["height: 0 !important","width: 0 !important","overflow: hidden !important","margin: 0 !important","padding: 0 !important"];for(var f in d)d[f]+=":not([data-skate])";return l.sheet.insertRule(d.join(",")+"{"+e.join(";")+"}",a),this},deafen:function(){var a=m.indexOf(this);return-1!==a&&(m.splice(a,1),k.sheet.deleteRule(k.sheet.cssRules.item(a)),l.sheet.deleteRule(l.sheet.cssRules.item(a))),this}},f.prototype={constructor:f,listen:function(){for(var a=this,b=document.querySelectorAll(this.skate.selector),c=0;c<b.length;c++)this.skate.trigger("ready",b[c]),this.skate.trigger("insert",b[c]);return document.addEventListener("DOMNodeInserted",function(b){b.target.msMatchesSelector(a.skate.selector)&&g(a,b.target)},!1),this},deafen:function(){return this}};var q=[],r=function(){return p?c:f}();r===c&&e(),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();