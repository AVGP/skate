!function(){"use strict";function a(a,c){return new b(a,c)}function b(b,c){"function"==typeof c&&(c={insert:c}),this.component=c,this.matcher=b,m(this.component,a.defaults),this.component.ready&&"string"==typeof this.matcher&&a.hide(this.matcher),this.component.listen&&this.listen()}function c(a,b,c){(c||a.matches(b))&&f(a,b)}function d(a,b,c){e(a,document.querySelectorAll(b),c)}function e(a,b,d){for(var e=0;e<b.length;e++)c(a,b[e],d)}function f(a,b){function c(){a.component.attributes&&s.addAttributeListener(a,b),g(a,b)}var d=/^[^(]+\([^,)]+,/,e=a.component.ready;b.__skates&&-1!==b.__skates.indexOf(a)||(b.__skates||(b.__skates=[]),b.__skates.push(a),m(b,a.component.extend),e&&d.test(e)?e(b,c):e?(e(b),c()):c())}function g(a,b){var c=a.component.insert;k(b,r),c&&c(b)}function h(b){a.find(b).forEach(function(a){a.component.attributes&&s.removeAttributeListener(a,b),a.component.remove&&a.component.remove(b)})}function i(){var b=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver,c=[];if(b){var d=new b(function(b){b.forEach(function(b){if(b.addedNodes)for(var c=0;c<b.addedNodes.length;c++)o(b.addedNodes[c])&&a.init(b.addedNodes[c]);if(b.removedNodes)for(var d=0;d<b.removedNodes.length;d++)o(b.removedNodes[d])&&h(b.removedNodes[d])})});return d.observe(document,{childList:!0,subtree:!0}),{addAttributeListener:function(a,d){var e=new b(function(b){var c=d.attributes[mutation.attributeName],e=a.component.attributes[c];e&&("function"==typeof e&&(e={init:e,update:e}),c&&"undefined"==typeof oldValue&&e.init?e.init(d,c.nodeValue):c&&e.update?e.update(d,c.nodeValue,b.oldValue):e.remove&&e.remove(d,b.oldValue))});c.push(e)},removeAttributeListener:function(){}}}}function j(){document.addEventListener("DOMNodeInserted",function(b){o(b.target)&&a.init(b.target)}),document.addEventListener("DOMNodeRemoved",function(a){o(a.target)&&h(a.target)});var b={1:function(a,b,c){a.update(b,c.newValue,c.prevValue)},2:function(a,b,c){(a.init||a.update)(b,c.newValue)},3:function(a,b,c){a.remove(b,c.prevValue)}};return{addAttributeListener:function(a,c){c.addEventListener("DOMAttrModified",function(d){var e=a.component.attributes[d.attrName];e&&b[d.attrChange](e,c,d)})},removeAttributeListener:function(a,b){b.removeEventListener("DOMAttrModified")}}}function k(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function l(a,b){var c=n(a);return c.forEach(function(a,d){c[d]+=b}),c.join(",")}function m(a,b){for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c])}function n(a){var b=a.split(",");return b.forEach(function(a,c){b[c]=a.replace(/^\s+/,"").replace(/\s+$/,"")}),b}function o(a){return"string"==typeof a.tagName}var p=document.getElementsByTagName("head")[0],q=document.createElement("style"),r="_skate",s=i()||j(),t=["moz","ms","o","webkit"],u=function(){var a=Element.prototype.matches;return t.some(function(b){var c=b+"MatchesSelector";return Element.prototype[c]?(a=c,!0):void 0}),function(b,c){return b&&1===b.nodeType&&b[a](c)}}();a.defaults={attributes:!1,extend:{},listen:!0},a.instances=[],a.init=function(b){return a.instances.forEach(function(a){a.init(b)}),a},a.destroy=function(){for(var b=a.instances.length-1;b>=0;b--)a.instances[b].deafen();return a},a.hide=function(b){var c=["position: absolute !important","clip: rect(0, 0, 0, 0)"];return q.sheet.insertRule(l(b,":not(."+r+")")+"{"+c.join(";")+"}",q.sheet.cssRules.length),a},a.find=function(b){var c=[];return a.instances.forEach(function(a){a.matches(b)&&c.push(a)}),c},b.prototype={init:function(a,b){return 1===a.nodeType?c(this,a,b):"string"==typeof a?d(this,a,b):a.nodeType||"number"!=typeof a.length||e(this,a,b),this},matches:function(a){return"function"==typeof this.matcher?this.matcher(a):"string"==typeof this.matcher?u(a,this.matcher):!1},listen:function(){return-1===a.instances.indexOf(this)&&(a.instances.push(this),"string"==typeof this.matcher?d(this,this.matcher,!0):e(this,document.querySelectorAll("*"))),this},deafen:function(){return-1!==a.instances.indexOf(this)&&a.instances.splice(a.instances.indexOf(this),1),this}},p.appendChild(q),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();
