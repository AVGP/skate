!function(){"use strict";function a(a,c){return new b(a,c)}function b(a,b){this.adapter=new z(this),this.elements=[],this.listening=!1,this.removeListener=null,this.selector=a,"function"==typeof b&&(b={insert:b}),void 0===b.listen&&(b.listen=!0),this.component=b,b.ready&&i(a),b.listen&&this.listen()}function c(a,b){function c(c){c&&(b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),b=c),d(a,b)}var e=a.component.ready,f=/^[^(]+\([^,)]+,/;e&&f.test(e)?e(b,c):e?(e(b),c()):c()}function d(a,b){k(b,q),a.elements.push(b),a.component.insert&&a.component.insert(b)}function e(a){this.listener=null,this.id=q+"-"+Math.random().toString().replace("0.",""),this.skate=a}function f(){o.innerHTML=y.join(",")+"{"+x+"animation: "+v+" .01s}"}function g(){m.appendChild(n),m.appendChild(o),n.innerHTML="@"+x+"keyframes "+v+"{from{opacity:1}to{opacity:1}}"}function h(a){this.listener=null,this.skate=a}function i(a){var b=["height: 0 !important","width: 0 !important","overflow: hidden !important","margin: 0 !important","padding: 0 !important"];p.sheet.insertRule(l(a,":not(."+q+")")+"{"+b.join(";")+"}",p.sheet.cssRules.length)}function j(a){var b=a.split(",");return b.forEach(function(a,c){b[c]=a.replace(/^\s+/,"").replace(/\s+$/,"")}),b}function k(a,b){a.classList?a.classList.add(b):a.className+=b}function l(a,b){var c=j(a);return c.forEach(function(a,d){c[d]+=b}),c.join(",")}var m=document.getElementsByTagName("head")[0],n=document.createElement("style"),o=document.createElement("style"),p=document.createElement("style"),q="skate",r=["moz","ms","o","webkit"],s=function(){var a=Element.prototype.matches;return r.some(function(b){var c=b+"MatchesSelector";Element.prototype[c]&&(a=c)}),function(b,c){return b[a](c)}}(),t=function(){var a=0,b=["ms","moz","webkit","o"];if(window.requestAnimationFrame)return window.requestAnimationFrame;for(var c=0;c<b.length;++c){var d=b[c]+"RequestAnimationFrame";if("function"==typeof window[d])return window[d]}return window.requestAnimationFrame?void 0:function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}}();t.end=function(){return window.cancelAnimationFrame?window.cancelAnimationFrame:function(a){clearTimeout(a)}}(),t.repeat=function(a){var b=function(){return a(),t(b)};return b()},b.prototype={listen:function(){if(this.listening)return this;var a=this;return this.listening=!0,this.adapter.listen(function(b){c(a,b)}),this.component.removed&&(this.removeListener=t.repeat(function(){for(var b=a.elements.length-1;b>-1;b--){var c=a.elements[b];c.parentNode||(a.elements.splice(b,1),a.component.removed(c))}})),this},deafen:function(){return this.listening?(this.adapter.deafen(),this.listening=!1,this.removeListener&&t.end(this.removeListener),this):this}};var u=["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"],v="__skate",w=function(){var a=document.documentElement.style,b=!1;return"undefined"!=typeof a.animation?"":(r.some(function(c){return"undefined"!=typeof a[c+"Animation"]?(b=c,!0):void 0}),b)}(),x=w?"-"+w+"-":"",y=[];e.prototype={constructor:e,listen:function(a){var b=this,c=document.querySelectorAll(l(this.skate.selector,".skate:not(."+this.id+")"));this.listener=function(c){c.animationName===v&&s(c.target,b.skate.selector)&&(k(c.target,b.id),a(c.target))};for(var d=0;d<c.length;d++)this.listener({animationName:v,target:c[d]});return u.forEach(function(a){document.addEventListener(a,b.listener,!1)}),j(this.skate.selector).forEach(function(a){-1===y.indexOf(a)&&y.push(a)}),f(),this},deafen:function(){var a=this;return u.forEach(function(b){document.removeEventListener(b,a.listener,!1)}),this.listener=null,j(this.skate.selector).forEach(function(a){var b=y.indexOf(a);-1!==b&&y.splice(b,1)}),f(),this}},h.prototype={constructor:h,listen:function(a){var b=this,c=document.querySelectorAll(this.skate.selector);this.listener=function(c){c.target.msMatchesSelector(b.skate.selector)&&a(c.target)};for(var d=0;d<c.length;d++)this.listener({target:c[d]});return document.addEventListener("DOMNodeInserted",this.listener,!1),this},deafen:function(){return document.removeEventListener("DOMNodeInserted",this.listener),this.listener=null,this}};var z=function(){return w===!1?h:e}();z===e&&g(),m.appendChild(p),"function"==typeof define&&define.amd?define("skate",function(){return a}):window.skate=a}();
